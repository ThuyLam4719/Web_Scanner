<!DOCTYPE html>
<html>

<head>
    <title>Lịch sử quét</title>
    <meta charset="utf-8">
</head>

<body>
    {% extends "base.html" %}
    {% block content %}
    <h2 style="text-align:center;"><span style="vertical-align:middle;"></span> LỊCH SỬ CÁC LẦN QUÉT</h2>
    <table class="table">
        <tr>
            <th style="text-align:center;">STT</th>
            <th style="text-align:center;">Domain</th>
            <th style="text-align:center;">Thời gian</th>
            <th class="result-col" style="text-align:center;">Kết quả</th>
            <th class="detail-col" style="text-align:center;">Xem chi tiết</th>
        </tr>
        {% for entry in history %}
        <tr>
            <td style="text-align:center;vertical-align:middle;">{{ entry.stt }}</td>
            <td style="text-align:center;vertical-align:middle;">{{ entry.domain }}</td>
            <td style="text-align:center;vertical-align:middle;">{{ entry.time }}</td>
            <td class="result-col" style="text-align:center;vertical-align:middle;">
                <span style="font-weight:600;">{{ entry.vuln_name }}</span>
            </td>
            <td class="detail-col" style="text-align:center;vertical-align:middle;">
                <a href="#" class="toggle-detail" data-target="full-{{ loop.index0 }}"
                    style="color:var(--primary);font-weight:600;">Xem</a>
                <div class="full-result" id="full-{{ loop.index0 }}" style="display:none;margin-top:8px;">
                    <pre style="max-height:400px;overflow:auto;">{{ entry.content }}</pre>
                </div>
            </td>
        </tr>
        {% endfor %}
    </table>
    <script>
        document.querySelectorAll('.toggle-detail').forEach(function (btn) {
            btn.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.getElementById(btn.dataset.target);
                if (target.style.display === 'none' || target.style.display === '') {
                    target.style.display = 'block';
                    btn.textContent = 'Thu gọn';
                } else {
                    target.style.display = 'none';
                    btn.textContent = 'Xem';
                }
            });
        });
    </script>
    {% endblock %}
</body>

</html>